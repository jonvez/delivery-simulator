// Delivery Manager Application - Prisma Schema
// Story 1.3: Initial setup with placeholder model

generator client {
  provider = "prisma-client-js"
  engineType = "library"
}

datasource db {
  provider = "postgresql"
}

// Placeholder model for testing Prisma setup
// Full schema will be implemented in later stories
model HealthCheck {
  id        String   @id @default(uuid())
  status    String
  timestamp DateTime @default(now())

  @@map("health_checks")
}

// Order model - Story 2.1
enum OrderStatus {
  PENDING
  ASSIGNED
  IN_TRANSIT
  DELIVERED
}

model Order {
  id              String      @id @default(uuid())
  customerName    String
  customerPhone   String
  deliveryAddress String
  orderDetails    String?
  status          OrderStatus @default(PENDING)

  // Geocoding support - Story 4.2
  latitude        Float?
  longitude       Float?

  // Assignment relationship - Story 3.4
  driverId        String?
  driver          Driver?     @relation(fields: [driverId], references: [id])

  // Lifecycle timestamps
  createdAt       DateTime    @default(now())
  assignedAt      DateTime?
  inTransitAt     DateTime?
  deliveredAt     DateTime?

  // For soft deletes or audit trail
  updatedAt       DateTime    @updatedAt

  @@map("orders")
  @@index([status])
  @@index([createdAt])
  @@index([driverId])
}

// Driver model - Story 3.1
model Driver {
  id          String   @id @default(uuid())
  name        String
  isAvailable Boolean  @default(true)
  createdAt   DateTime @default(now())

  // Assignment relationship - Story 3.4
  orders      Order[]

  @@map("drivers")
  @@index([isAvailable])
}
